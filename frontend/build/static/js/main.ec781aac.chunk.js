(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{38:function(t,e,n){},57:function(t,e,n){},64:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),s=n(32),r=n.n(s),c=(n(38),n(10)),i=n(11),l=n(13),u=n(12),h=n(15),j=n.n(h),d=(n.p,n(57),n(8)),b=n(0),O=function(t){var e=t.author;return Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:e.first_name}),Object(b.jsx)("td",{children:Object(b.jsx)(d.b,{to:"author/".concat(e.id),children:e.last_name})}),Object(b.jsx)("td",{children:e.birthday_year})]})},f=function(t){var e=t.authors;return Object(b.jsxs)("table",{children:[Object(b.jsx)("th",{children:"First name"}),Object(b.jsx)("th",{children:"Last name"}),Object(b.jsx)("th",{children:"Birthday year"}),e.map((function(t){return Object(b.jsx)(O,{author:t})}))]})},p=function(t){var e=t.book,n=t.authors,a=t.deleteBook;return Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:e.id}),Object(b.jsx)("td",{children:e.name}),Object(b.jsx)("td",{children:e.authors.map((function(t){var e=n.find((function(e){return e.id==t}));if(e)return e.last_name}))}),Object(b.jsx)("td",{children:Object(b.jsx)("button",{onClick:function(){return a(e.id)},type:"button",children:"Delete"})})]})},v=function(t){var e=t.books,n=t.authors,a=t.deleteBook;return Object(b.jsxs)("table",{children:[Object(b.jsx)("th",{children:"Id"}),Object(b.jsx)("th",{children:"Name"}),Object(b.jsx)("th",{children:"Authors"}),e.map((function(t){return Object(b.jsx)(p,{book:t,authors:n,deleteBook:a})}))]})},x=n(2),m=function(t){var e=t.book;return Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:e.id}),Object(b.jsx)("td",{children:e.name}),Object(b.jsx)("td",{children:e.authors})]})},g=function(t){var e=t.books,n=Object(x.g)().id,a=e.filter((function(t){return t.authors.includes(parseInt(n))}));return Object(b.jsxs)("table",{children:[Object(b.jsx)("th",{children:"Id"}),Object(b.jsx)("th",{children:"Name"}),Object(b.jsx)("th",{children:"Authors"}),a.map((function(t){return Object(b.jsx)(m,{book:t})}))]})},k=n(18),y=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={login:"",password:""},a}return Object(i.a)(n,[{key:"handleChange",value:function(t){this.setState(Object(k.a)({},t.target.name,t.target.value))}},{key:"handleSubmit",value:function(t){this.props.get_token(this.state.login,this.state.password),t.preventDefault()}},{key:"render",value:function(){var t=this;return Object(b.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(b.jsx)("input",{type:"text",name:"login",placeholder:"login",value:this.state.login,onChange:function(e){return t.handleChange(e)}}),Object(b.jsx)("input",{type:"password",name:"password",placeholder:"password",value:this.state.password,onChange:function(e){return t.handleChange(e)}}),Object(b.jsx)("input",{type:"submit",value:"Login"})]})}}]),n}(o.a.Component),_=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={name:"",authors:[]},a}return Object(i.a)(n,[{key:"handleChange",value:function(t){this.setState(Object(k.a)({},t.target.name,t.target.value))}},{key:"handleAuthorChange",value:function(t){if(t.target.selectedOptions){for(var e=[],n=0;n<t.target.selectedOptions.length;n++)e.push(t.target.selectedOptions.item(n).value);this.setState({authors:e})}else this.setState({authors:[]})}},{key:"handleSubmit",value:function(t){this.props.createBook(this.state.name,this.state.authors),t.preventDefault()}},{key:"render",value:function(){var t=this;return Object(b.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(b.jsx)("input",{type:"text",name:"name",placeholder:"name",value:this.state.name,onChange:function(e){return t.handleChange(e)}}),Object(b.jsx)("select",{multiple:!0,name:"authors",onChange:function(e){return t.handleAuthorChange(e)},children:this.props.authors.map((function(t){return Object(b.jsxs)("option",{value:t.id,children:[t.first_name," ",t.last_name]})}))}),Object(b.jsx)("input",{type:"submit",value:"Create"})]})}}]),n}(o.a.Component),C=n(17),S=(n(64),n(65),function(t){var e=t.location;return Object(b.jsxs)("div",{children:["Page ",e.pathname," not found."]})}),N=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={authors:[],books:[],token:""},a}return Object(i.a)(n,[{key:"is_auth",value:function(){return!!this.state.token}},{key:"get_token_from_storage",value:function(){var t=new C.a;this.setState({token:t.get("token")},this.get_data)}},{key:"get_headers",value:function(){var t={"Content-Type":"application/json"},e=new C.a;return t.Authorization="Token "+e.get("token"),t}},{key:"get_data",value:function(){var t=this,e=this.get_headers();j.a.get("http://127.0.0.1:8000/api/authors/",{headers:e}).then((function(e){var n=e.data;t.setState({authors:n})})).catch((function(e){t.setState({authors:[]}),console.log(e)})),j.a.get("http://127.0.0.1:8000/api/books/",{headers:e}).then((function(e){var n=e.data;t.setState({books:n})})).catch((function(e){t.setState({books:[]}),console.log(e)}))}},{key:"get_token",value:function(t,e){var n=this;console.log(t,e),j.a.post("http://127.0.0.1:8000/api-token-auth/",{username:t,password:e}).then((function(t){(new C.a).set("token",t.data.token),n.setState({token:t.data.token},n.get_data)})).catch((function(t){return console.log(t)}))}},{key:"logout",value:function(){(new C.a).set("token",""),this.setState({token:""},this.get_data)}},{key:"componentDidMount",value:function(){this.get_token_from_storage()}},{key:"deleteBook",value:function(t){var e=this,n=this.get_headers();j.a.delete("http://127.0.0.1:8000/api/books/".concat(t,"/"),{headers:n}).then((function(t){e.get_data()})).catch((function(t){console.log(t)}))}},{key:"createBook",value:function(t,e){var n=this;if(t&&0!=e.length){var a=this.get_headers();j.a.post("http://127.0.0.1:8000/api/books/",{name:t,authors:e},{headers:a}).then((function(t){n.get_data()})).catch((function(t){console.log(t)}))}else console.log("Empty params:",t,e)}},{key:"render",value:function(){var t=this;return Object(b.jsx)("div",{children:Object(b.jsxs)(d.a,{children:[Object(b.jsx)("header",{children:Object(b.jsxs)("nav",{className:"navbar navbar-expand-md navbar-dark fixed-top bg-dark",children:[Object(b.jsx)("a",{className:"navbar-brand",href:"#",children:"DRF"}),Object(b.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarCollapse","aria-controls":"navbarCollapse","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(b.jsx)("span",{className:"navbar-toggler-icon"})}),Object(b.jsx)("div",{className:"collapse navbar-collapse",id:"navbarCollapse",children:Object(b.jsxs)("ul",{className:"navbar-nav mr-auto",children:[Object(b.jsx)("li",{className:"nav-item active",children:Object(b.jsx)(d.b,{className:"nav-link",to:"/",children:"Authors"})}),Object(b.jsx)("li",{className:"nav-item active",children:Object(b.jsx)(d.b,{className:"nav-link",to:"/books",children:"Books"})}),Object(b.jsx)("li",{className:"nav-item active",children:Object(b.jsx)(d.b,{className:"nav-link",to:"/books/create",children:"Create book"})}),Object(b.jsx)("li",{className:"nav-item active",children:this.is_auth()?Object(b.jsx)("a",{className:"nav-link",onClick:function(){return t.logout()},children:"Logout"}):Object(b.jsx)(d.b,{className:"nav-link",to:"/login",children:"Login"})})]})})]})}),Object(b.jsx)("main",{role:"main",class:"flex-shrink-0",children:Object(b.jsx)("div",{className:"container",children:Object(b.jsxs)(x.d,{children:[Object(b.jsx)(x.b,{exact:!0,path:"/",component:function(){return Object(b.jsx)(f,{authors:t.state.authors})}}),Object(b.jsx)(x.b,{exact:!0,path:"/books",component:function(){return Object(b.jsx)(v,{books:t.state.books,authors:t.state.authors,deleteBook:function(e){return t.deleteBook(e)}})}}),Object(b.jsx)(x.b,{exact:!0,path:"/books/create",component:function(){return Object(b.jsx)(_,{authors:t.state.authors,createBook:function(e,n){return t.createBook(e,n)}})}}),Object(b.jsx)(x.b,{exact:!0,path:"/login",component:function(){return Object(b.jsx)(y,{get_token:function(e,n){return t.get_token(e,n)}})}}),Object(b.jsx)(x.a,{from:"/authors",to:"/"}),Object(b.jsx)(x.b,{path:"/author/:id",children:Object(b.jsx)(g,{books:this.state.books})}),Object(b.jsx)(x.b,{component:S})]})})})]})})}}]),n}(o.a.Component),B=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(e){var n=e.getCLS,a=e.getFID,o=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),a(t),o(t),s(t),r(t)}))};r.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(N,{})}),document.getElementById("root")),B()}},[[66,1,2]]]);
//# sourceMappingURL=main.ec781aac.chunk.js.map